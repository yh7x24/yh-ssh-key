---
# sub tasks for yh-mongo


# 配置
- name: verify-env-dir
  file: state=directory path="~/bin/env.d" recurse=yes

- name: config-mongo-env
  template:
    src: mongo.env.j2
    dest: "~/bin/env.d/mongo.env"
    mode: 0755


# 匹配用户配置文件
- block:
  - set_fact: user_profile="~/.bash_profile"
    when: ansible_os_family == "RedHat"
  - set_fact: user_profile="~/.bashrc"
    when: ansible_os_family == "Debian"
  - debug: msg="user_profile={{ user_profile }}"

- name: append-mongo-2-bash-env-file
  lineinfile:
    path: "{{ user_profile }}"
    line: "source ~/bin/env.d/mongo.env # added by yh-mongo"
    create: yes
  tags: mongo.env
